# Pod

##### 一些概念

ruby是一门脚本语言  
gem是管理ruby库和程序的标准工具包 - RubyGems is a package management framework for Ruby.  
CocoaPods是一个负责管理iOS项目中第三方库的工具  
CocoaPods是基于ruby ecosystem（生态）的，因此首先需要在机器上安装ruby，然后安装gem，使用gem安装或卸载cocaPods  
spec: sepcification: 规格；说明书；详述

##### CocoaPod的安装

更换gem source为rubychina:  
gem sources —remove [https://rubygems.org/](https://rubygems.org/) \# 移除掉原有的源  
gem sources -a gem sources --add [https://gems.ruby-china.com/](https://gems.ruby-china.com/) \#\(参考：[https://gems.ruby-china.com/](https://gems.ruby-china.com/)\)  
gem sources -l \# 验证是否成功  
源: ruby china官网地址：[https://gems.ruby-china.com/](https://gems.ruby-china.com/)

upgrade to the latest RubyGems:  
gem update —system  
或： sudo gem update —system

OS X 10.11 以前安装命令为：  
sudo gem install cocoapods \# 安装cocoapods

Mac系统为OS X EL Capitan安装命令为：  
sudo gem install -n /usr/local/bin cocoapods  \# 安装最新版本  
sudo gem install -n /usr/local/bin cocoapods -v 1.0.0 \# 安装指定版本  
sudo gem install -n /usr/local/bin cocoapods --pre \# 安装最新的release beta版本

卸载CocoaPods:  
sudo gem uninstall cocoapods

查看pod版本：  
pod —version

cocoapods本地路径： .cocoapods/repos/master

##### 创建Spec

You can create one by hand, or run pod spec create to generate a stub. Podspecs are ruby files.  
`pod spec create Hello`会生成Hello.podspec文件.

From [官网资料：](http://guides.cocoapods.org/making/specs-and-specs-repo.html)

The [Specs Repo](https://github.com/CocoaPods/Specs) is the repository on GitHub that contains the list of all available pods. Every library has an individual folder, which contains sub folders of the available versions of that pod.

Here is an example spec:

```Ruby
# A Simple specification.
Pod::Spec.new do |spec|
  spec.name         = 'libPusher'
  spec.version      = '1.3'
  spec.license      = 'MIT'
  spec.summary      = 'An Objective-C client for the Pusher.com service'
  spec.homepage     = 'https://github.com/lukeredpath/libPusher'
  spec.author       = 'Luke Redpath'
  spec.source       = { :git => 'git://github.com/lukeredpath/libPusher.git', :tag => 'v1.3' }
  spec.source_files = 'Library/*'
  spec.requires_arc = true
  spec.dependency 'SocketRocket'
end
```

A specification with subspecs

```Objective-C
Pod::Spec.new do |spec|
  spec.name          = 'ShareKit'
  spec.source_files  = 'Classes/ShareKit/{Configuration,Core,Customize UI,UI}/**/*.{h,m,c}'
  # ...

  spec.subspec 'Evernote' do |evernote|
    evernote.source_files = 'Classes/ShareKit/Sharers/Services/Evernote/**/*.{h,m}'
  end

  spec.subspec 'Facebook' do |facebook|
    facebook.source_files   = 'Classes/ShareKit/Sharers/Services/Facebook/**/*.{h,m}'
    facebook.compiler_flags = '-Wno-incomplete-implementation -Wno-missing-prototypes'
    facebook.dependency 'Facebook-iOS-SDK'
  end
  # ...
end
```

Subspecs are a way of chopping up the functionality of a Podspec, allowing people to install a subset of your library.

With the above example a Podfile using pod 'ShareKit' results in the inclusion of the whole library, while pod 'ShareKit/Facebook' can be used if you are interested only in the Facebook specific parts.

A specification with subspecs within submodules

If you have some submodules in the repository you need to set the `:submodules` key of the `s.source` hash to true. Then you'll be able to specify subspec like above.

```Ruby
Pod::Spec.new do |spec|
  spec.name          = 'SDLoginKit'
  spec.source        =  { 
      :git => 'https://github.com/dulaccc/SDLoginKit.git',
      :tag => '1.0.2', 
      :submodules => true 
  }
  # ...

  spec.subspec 'SDKit' do |sdkit|
    sdkit.source_files = 'SDKit/**/*.{h,m}'
    sdkit.resources    = 'SDKit/**/Assets/*.png'
  end
  # ...
end
```


**Podfile Syntax Reference**
[Podfile语法](http://guides.cocoapods.org/syntax/podfile.html#podfile)

A stub specification file can be generated by the [pod spec create](http://guides.cocoapods.org/terminal/commands.html#pod_spec_create) command.

The specification DSL provides great flexibility and dynamism. Moreover, the DSL adopts the convention over configuration and thus it can be very simple:

DSL的全称是domain-specific language，它在wiki上的定义如下：
A domain-specific language (DSL) is a computer language specialized to a particular application domain.
与之相对的是GPL(general-purpose language)。
DSL指的是针对特定应用领域而设计使用的计算机语言，而GPL指的是针对跨应用领域而设计使用的计算机语言。
常见的DSL有:HTML,Shell,make语言,ant语言,maven语言，rpm语言，dpkg语言，awk语言，正则表达式，dc计算机语言等，有些DSL语言又被称为微型语言
常见的GPL有:Java,C等

```Ruby
Pod::Spec.new do |s|
    s.name         = 'ZZQRManager'
    s.version      = '1.3'
    s.summary      = 'An easy way to use qr manage'
    s.homepage     = 'https://github.com/ACommonChinese/ZZQRManager/'
    s.license      = 'MIT'
    s.authors      = {'ACommonChinese' => 'liuxing8807@126.com'}
    s.platform     = :ios, '11.0'
    s.source       = {:git => "https://github.com/ACommonChinese/ZZQRManager.git", :tag => s.version}
    s.source_files = 'ZZQRManager/*.{h,m}'
    s.resource     = 'ZZQRManager/ZZQRManager.bundle'
    s.frameworks   = "UIKit" # spec.frameworks = 'QuartzCore', 'CoreData'
    s.requires_arc = true # The default value of this attribute is true.
    s.ios.deployment_target = '8.0'
    # spec.dependency 'AFNetworking', '~> 1.0'
    # spec.dependency 'RestKit/CoreData', '~> 0.20.0'
    # spec.ios.dependency 'MBProgressHUD', '~> 0.5'
end
```

#### Pod的使用

1. 新建Podfile文件
cd /… …/JYCocoaPodsTest
touch Podfile # 或者调用：pod init

2. 编辑Podfile文件（假设项目名为JYCocoaPodsTest）
示例：1

```Ruby
platform :ios, '9.0'
inhibit_all_warnings!

xcodeproj 'JYCocoaPodsTest'
workspace 'JYCocoaPodsTest' #指定应该包含所有projects的Xcode workspace. 如果没有显示指定workspace并且在Podfile所在目录只有一个project，那么project的名称会被用作于workspace的名称

use_frameworks!

target 'JYCocoaPodsTest' do 
pod 'AFNetworking'
pod 'JYCarousel', '0.0.1'

end
```

示例 2

```Ruby
source 'ssh://git@gitlab.9ijx.com:9830/iOS/Specs.git'
source 'https://github.com/CocoaPods/Specs.git'
 
platform :ios, '7.0'
use_frameworks! # swift项目默认 use_frameworks! OC项目cocoapods 默认 #use_frameworks!
inhibit_all_warnings! # 屏蔽cocoapods库里面的所有警告 pod 'JYCarousel', :inhibit_warnings => true
workspace 'JYCocoaPodsTest'
target 'JYCocoaPodsTest' do
pod 'AFNetworking'
pod 'JYCarousel', '0.0.1'
pod 'WCJCache', :git => "http://gitlab.9ijx.com/iOS/WCJCache.git"
 
target :JYCocoaPodsTestUITests do
    inherit! :search_paths #明确指定继承于父层的所有pod，默认就是继承的
    pod 'YYText'
 
end
```

**target**

```Ruby
target 'xxxx' do
  // ......
end

指定特定Target的依赖库, 可以嵌套子Target的依赖库

比如：

target 'JYCocoaPodsTest' do
pod 'AFNetworking'
pod 'JYCarousel', '0.0.1'

target :JYCocoaPodsTestUITests do
    inherit! :search_paths
    pod 'YYText'
 
end

end
```

即Target JYCocoaPodsTestUITests使用了YYText

**source**

指定specs的位置,自定义添加自己的podspec。公司内部使用

```Ruby
cocoapods 官方source是隐式的需要的，一旦你指定了其他source 你就需要也把官方的指定上
source 'ssh://git@gitlab.9ijx.com:9830/iOS/Specs.git'
source 'https://github.com/CocoaPods/Specs.git' # 官方的
```

当我们使用pod install或者pod setup时，会自动在~/.cocoapods/repo目录下生成相关source文件夹。


**依赖库的基本写法**
```Ruby
pod 'JYCarousel', //不显式指定依赖库版本，表示每次都获取最新版本
pod 'JYCarousel', '0.01'//只使用0.0.1版本
pod 'JYCarousel', '>0.0.1' //使用高于0.0.1的版本
pod 'JYCarousel', '>=0.0.1' //使用大于或等于0.0.1的版本
pod 'JYCarousel', '<0.0.2' //使用小于0.0.2的版本
pod 'JYCarousel', '<=0.0.2' //使用小于或等于0.0.2的版本
pod 'JYCarousel', '~>0.0.1' //使用大于等于0.0.1但小于0.1的版本，相当于>=0.0.1&&<0.1
pod 'JYCarousel', '~>0.1' //使用大于等于0.1但小于1.0的版本
pod 'JYCarousel', '~>0' //高于0的版本，写这个限制和什么都不写是一个效果，都表示使用最新版本
```

**依赖库的自定义写法**
`pod 'JYCarousel', :path => '/Users/Dely/Desktop/JYCarousel'`






#### 提交自己的Podspec
更新Podspec索引文件:
pod setup
pod setup将所有第三方的Podspec索引文件更新到本地的~/.cocoapods/repos目录下
所有的第三方开源库的Podspec文件都托管在https://github.com/CocoaPods/Specs
我们需要把这个Podspec文件保存到本地，这样才能让我们使用命令pod search 开源库搜索一个开源库，怎样才能把github上的Podspec文件保存本地呢？那就是 pod setup
如果执行 pod setup，并且命令执行成功，说明把github上的Podsepc文件更新到本地，那么会创建~/.cocoapods/repos目录，并且repos目录里有一个master目录，这个master目录保存的就是github上所有第三方开源库的Podspec索引文件

##### Private Pods

[官网Private Pods](http://guides.cocoapods.org/making/private-cocoapods.html)

##### 参考链接：

* 参考链接： [https://blog.csdn.net/jiankeufo/article/details/79362660](https://blog.csdn.net/jiankeufo/article/details/79362660)
* 官方文档：[http://guides.cocoapods.org/making/specs-and-specs-repo.html](http://guides.cocoapods.org/making/specs-and-specs-repo.html)
* 官方引导页：[https://guides.cocoapods.org/](https://guides.cocoapods.org/)
* Github地址：[https://github.com/CocoaPods](https://github.com/CocoaPods)
  .spec & .spec.json \[[https://github.com/CocoaPods/guides.cocoapods.org/issues/48](https://github.com/CocoaPods/guides.cocoapods.org/issues/48)
  [https://my.oschina.net/FEEDFACF/blog/1611959\]\(https://github.com/CocoaPods/guides.cocoapods.org/issues/48](https://my.oschina.net/FEEDFACF/blog/1611959]%28https://github.com/CocoaPods/guides.cocoapods.org/issues/48)
  [https://my.oschina.net/FEEDFACF/blog/1611959](https://my.oschina.net/FEEDFACF/blog/1611959)\)



