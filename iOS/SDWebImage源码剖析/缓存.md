# 缓存

网络缓存一般指内存缓存和磁盘缓存，iOS提供了NSURLCache用于处理网络缓存。

### NSURLCache
An object that maps URL requests to cached response objects.
The NSURLCache class implements the caching of responses to URL load requests by mapping NSURLRequest objects to NSCachedURLResponse objects. It provides a composite in-memory and on-disk cache, and lets you manipulate the sizes of both the in-memory and on-disk portions. You can also control the path where cache data is stored persistently.

### 控制文件缓存的有效性
服务器的文件存贮，大多采用资源变动后就重新生成一个链接的做法。但不排除存在不同文件使用同一个链接的情况。那么如果服务端的file更改了，本地已经有了缓存。如何更新缓存？
这种情况下需要借助 ETag 或 Last-Modified 判断图片缓存是否有效。
在浏览器第一次请求某一个URL时，服务器端的返回状态会是200，内容是你请求的资源，同时有一个Last-Modified的属性标记此文件在服务期端最后被修改的时间，格式类似这样：
Last-Modified: Fri, 12 May 2006 18:53:33 GMT

以请求百度上面一张图片为例：
https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1559197432643&di=d99c5caa027c418d1995d1646e6f2c2e&imgtype=0&src=http%3A%2F%2Fpic15.nipic.com%2F20110628%2F1369025_192645024000_2.jpg





